;;; -*- asm -*-

;;;  SXB Block Addresses
    BLK_VIA_USB = $7fe0
    BLK_VIA_PORT = $7fc0
    BLK_PIA_PORT = $7fa0
    BLK_ACIA_PORT = $7f80
    BLK_XBUS_CS0 = $7f00
    BLK_XBUS_CS1 = $7f20
    BLK_XBUS_CS2 = $7f40
    BLK_XBUS_CS3 = $7f60

    BANK_SRAM_START = $08
    BANK_SRAM_END = $0f

;;; PIA (LEDs and pio header on EDU)
    PIA_A_CTRL = BLK_PIA_PORT + 1
    PIA_A_DATA = BLK_PIA_PORT + 0
    PIA_B_CTRL = BLK_PIA_PORT + 3
    PIA_B_DATA = BLK_PIA_PORT + 2

    PIA_DDR_ACCESS_MASK = 4
    PIA_DDR_ACCESS_DDR = 0
    PIA_DDR_ACCESS_PIA = PIA_DDR_ACCESS_MASK


;;; Shitty ACIA chip.  Please ignore and use something else
    ACIA_DATA = BLK_ACIA_PORT + 0
    ACIA_STATUS = BLK_ACIA_PORT + 1
    ACIA_COMMAND = BLK_ACIA_PORT + 2
    ACIA_CONTROL = BLK_ACIA_PORT + 3

    ACIA_STATUS_PARITY_ERR = $01
    ACIA_STATUS_FRAMING_ERR = $02
    ACIA_STATUS_OVERRUN = $04
    ACIA_STATUS_RECV_FULL = $08
    ACIA_STATUS_XMIT_EMPTY = $10
    ACIA_STATUS_DCD = $20
    ACIA_STATUS_DSR = $40
    ACIA_STATUS_IRQ = $80
    
    ACIA_CONTROL_1_STOP = $00
    ACIA_CONTROL_2_STOP = $80
    ACIA_CONTROL_OTHER_STOP = $80
    ACIA_CONTROL_WORD_LEN_8 = $00
    ACIA_CONTROL_WORD_LEN_7 = $20
    ACIA_CONTROL_WORD_LEN_6 = $40
    ACIA_CONTROL_WORD_LEN_5 = $60
    ACIA_CONTROL_RCS_EXTERNAL = $00
    ACIA_CONTROL_RCS_BAUD = $10

    ACIA_CONTROL_N81 = (ACIA_CONTROL_1_STOP | ACIA_CONTROL_WORD_LEN_8)

    ACIA_CONTROL_BAUD_16X = $00
    ACIA_CONTROL_BAUD_50 = ($01 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_75 = ($02 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_109_92 = ($03 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_134_58 = ($04 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_150 = ($05 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_300 = ($06 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_600 = ($07 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_1200 = ($08 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_1800 = ($09 | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_2400 = ($0a | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_3600 = ($0b | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_4800 = ($0c | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_7200 = ($0d | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_9600 = ($0e | ACIA_CONTROL_RCS_BAUD)
    ACIA_CONTROL_BAUD_19200 = ($0f | ACIA_CONTROL_RCS_BAUD)

    ACIA_CONTROL_9600_N81 = (ACIA_CONTROL_N81 | ACIA_CONTROL_BAUD_9600)
    ACIA_CONTROL_19200_N81 = (ACIA_CONTROL_N81 | ACIA_CONTROL_BAUD_19200)

    ACIA_COMMAND_PARITY_CTRL_ODD_TR = $00
    ACIA_COMMAND_PARITY_CTRL_EVEN_TR = $40
    ACIA_COMMAND_PARITY_CTRL_MARK_XMIT = $80
    ACIA_COMMAND_PARITY_CTRL_SPACE_XMIT = $c0
    ACIA_COMMAND_PARITY_MODE_ENABLED = $20
    ACIA_COMMAND_RCVR_ECHO = $10
    ;;  Don't trust the two below.  The data sheet is wonky, and I don't
    ;;  really care about HW flow control anyway
    ACIA_COMMAND_XMIT_INTR_CTRL_RTS_HIGH = $04
    ACIA_COMMAND_XMIT_INTR_CTRL_RTS_LOW = $08
    ACIA_COMMAND_RCVR_IRQ_DISABLE = $02
    ACIA_COMMAND_DTR_READY = $01
    ;; Here's to hoping:
    ACIA_COMMAND_NORMAL = (ACIA_COMMAND_RCVR_IRQ_DISABLE | ACIA_COMMAND_DTR_READY)

;;; USB on VIA at BLK_VIA_USB = $7fe0
    USB_CTRL_OR  = BLK_VIA_USB
    USB_CTRL_IR  = USB_CTRL_OR
    USB_DATA_OR  = BLK_VIA_USB+$1
    USB_DATA_IR  = USB_DATA_OR
    USB_CTRL_DDR = BLK_VIA_USB+$2
    USB_DATA_DDR = BLK_VIA_USB+$3
    USB_INTR_FLG = BLK_VIA_USB+$d
    USB_INTR_ENA = BLK_VIA_USB+$e
    ;; Add other defns here.  FIXME
    
    USB_CTRL_TXEb = %00000001   ; Input from FT245, transmit FIFO ready
    USB_CTRL_RXFb = %00000010   ; Input from FT245, receiver FIFO has data
    USB_CTRL_WR   = %00000100   ; Output to FT245, strobe high after writing data
    USB_CTRL_RDb  = %00001000   ; Output to FT245, strobe low to read data
    USB_CTRL_DEF  = USB_CTRL_RDb ; Default is to set the RDb bit high, WR low
    USB_CTRL_WRSTR = USB_CTRL_RDb|USB_CTRL_WR
    USB_CTRL_RDSTR = 0
